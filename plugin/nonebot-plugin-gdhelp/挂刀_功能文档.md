## 功能

### 挂刀日报

- 挂刀日报只在群内推送

- 每天8点查询箱子比例，发送挂刀比例最低的5个箱子，并计算7天和30天标准差

- 箱子数据通过链接动态获得

- ```
  商品名称：{name}
  第三方最低价格(30天): 4.55 标准差: 0.15
  第三方最低价格(7天): 4.44 标准差: 0.06
  Steam购买者价格(30天): 7.07 标准差: 0.18
  Steam购买者价格(7天): 7.03 标准差: 0.07
  30天平均价格挂刀比例0.74
  7天平均价格挂刀比例0.73
  挂刀网：https://www.hangknife.com/#/itemPage?marketHashName={name}
  ```
  

### 挂刀订阅

- 输入物品，购买价格，每30分钟查询挂刀比例
- 若高于输入时的历史最低比例推送提示
- 支持在线增删查
- 每天定时发送挂刀比例
  - 按照添加订阅的方式进行推送

- ```
  商品名称：{name}
  Steam购买者价格：7.03
  挂刀比例：0.73
  批量出售链接：https://steamcommunity.com/market/multisell?appid=730&contextid=2&items[]={name}
  ```


### 帮助

- 展示常用功能指令和用法
- 触发为：挂刀帮助
- ```
  欢迎使用挂刀帮助，数据有延迟具体以steam官方为准
  开启挂刀推送:在本群开启挂刀推送，私聊不支持
  添加挂刀推送 {name}|{price}:添加挂刀推送
  	注：自行替换{}内的内容，不要保留{}，中间的空格保留，默认7天后开始推送
  查询挂刀推送：查询添加的挂刀记录
  删除挂刀推送 {name}:删除添加的挂刀推送
  查询挂刀 {name|可选}：查询挂刀，默认返回推送列表的所有纪录，输入商品名称时只查询该记录
  ```
  
  

## 配置

配置文件`config/gd_config.yaml`，关于 `yaml` 配置文件格式请参考 [Yaml 语法](https://www.runoob.com/w3cnote/yaml-intro.html), 建议使用 `vscode` 编辑器进行编辑, 善用 `Ctrl+F` 快速定位配置项

```yaml
PUSH_ON: true #推送开关
PUSH_TIME: 8  #推送时间
PUSH_CONTROL: #推送控制
	GROUP: #群控制
        TYPE: "white" #black黑名单，white白名单，默认白名单有需要自行修改
        GROUP_ID:
            - 12345
            - 45567
  USER: #私聊控制
    - 12345
    - 1234
```

## 数据文件

以JSON方式存储在机器人目录下的data文件夹

```json
[
    {
        "user":123456789,
        "record":[
            {
                "name":"test",
                "price":10.1,
                "sold":12.1,
                "time":2024-12-12,
                "type":"private",
                "group":
            },
            {
                "name":"test",
                "price":10.1,
                "sold":12.1,
                "time": 2024-12-12,
                "type":"group",
                "group":123456789
            }
        ]
    }
]
```

| 字段  | 备注                        | 数据类型      |
| ----- | --------------------------- | ------------- |
| user  | QQ号                        | int           |
| name  | 商品名称（复制挂刀网）      | str           |
| price | 购买价格                    | float         |
| sold  | 最高卖出价格                | float         |
| time  | 添加时间，默认7天后开始查询 | time          |
| type  | 添加方式，群聊/私聊         | group/private |
| group | 群号                        | int           |

## 指令

### 开启挂刀推送

- 功能：在本群启用挂刀推送

### 添加挂刀推送

-  功能：添加挂刀推送，支持私聊和群聊添加
- 参数:
  - 商品名称（**必填**），从[挂刀网](https://www.hangknife.com/#/)复制完整英文名
  - 购买价格（**必填**），与商品名称中间用|分隔
  - 指令样例：`添加挂刀推送 Recoil Case|0.85`
    - 或者采用多轮对话的方式添加，`添加挂刀推送`后提示输入商品名称，再提示输入购买价格

### 查询挂刀推送

- 功能：查询挂刀推送，支持私聊和群聊，两者记录分开

### 删除挂刀推送

- 功能：删除挂刀推送，支持私聊和群聊，两者记录分开
- 参数：
  - 商品名称（**必填**），从查询记录中复制

### 查询挂刀

-   功能：查询挂刀，默认返回推送列表的所有纪录，输入商品名称时只查询该记录
-   参数：
    -   商品名称（选填）
    -   指令样例：`查询挂刀 Recoil Case`

### 挂刀帮助

- 功能：显示指令帮助
